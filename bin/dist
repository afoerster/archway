#!/bin/bash
set -euo pipefail
sbt "set every test in assembly := {}" api/assembly
npm install typescript
npm install
npm run-script prepare
rm -rf distribution/
mkdir distribution/
rsync -a --exclude 'index.html' public/ dist/
cp bin/run-java.sh distribution/
cp -r templates distribution/
cp api/target/scala-2.12/archway-server.jar distribution/
cp api/src/main/resources/application.conf distribution/
cp -r dist distribution/
cp -r flyway distribution/
